dataset_id: Call_CDR
dataset_version: 3
description: events lost in imei_tac - d_tacs
field: TECHNOLOGY_CELL_CD
id: TECHNOLOGY_CELL_CD-COUNT_OUTSIDE_OF_TECHNOLOGY_02
id_jira: val-551
metrics:
- result
product: Neptuno
sources:
- dataset_id: IMEI_TAC
  dataset_version: 3
  name: IMEI_TAC
- dataset_id: D_TACS
  dataset_version: 4
  name: D_TACS
sql: select (SELECT count(*) as val1 from (select IMEI_1_ID, TAC_ID, OPERATOR_ID,
  START_CELL_1_ID, SESSION_DURATION_QT, EVENT_TM from validation_data_table left join
  (select distinct IMEI_ID, TAC_ID from IMEI_TAC) on IMEI_1_ID=IMEI_ID where IMEI_1_ID
  is not null and TAC_ID is not null and START_CELL_1_ID is not null)) - (SELECT count(*)
  as val2 from (select IMEI_1_ID, imeiFilter_1.OPERATOR_ID, TECHNOLOGY_4G_OB_IND,
  TECHNOLOGY_3G_CD, START_CELL_1_ID, SESSION_DURATION_QT, case when TECHNOLOGY_4G_OB_IND
  != 'No LTE' then '4G' when TECHNOLOGY_3G_CD != 'No' then '3G' else '2G' end as TECHNOLOGY_TYPE
  from (select IMEI_1_ID, TAC_ID, OPERATOR_ID, START_CELL_1_ID, SESSION_DURATION_QT,
  EVENT_TM from validation_data_table left join (select distinct IMEI_ID, TAC_ID from
  IMEI_TAC) as imeiFilter on IMEI_1_ID=IMEI_ID where IMEI_1_ID is not null and TAC_ID
  is not null and START_CELL_1_ID is not null) as imeiFilter_1 left outer join D_TACS
  on imeiFilter_1.TAC_ID = D_TACS.TAC_ID where TECHNOLOGY_4G_OB_IND is not null and
  TECHNOLOGY_3G_CD is not null)) as result
type: info
